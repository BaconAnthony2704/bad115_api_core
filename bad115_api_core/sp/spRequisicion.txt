CREATE PROCEDURE spRequisicion_ver
@p_id AS BIGINT=NULL
AS
BEGIN
	IF EXISTS(SELECT * FROM REQUISICION WHERE IDREQUISICION=@p_id)
		SELECT * FROM REQUISICION WHERE IDREQUISICION=@p_id
	ELSE
		SELECT * FROM REQUISICION
END

CREATE PROCEDURE spRequisicion_guardar
	@p_ESTADO AS INT      ,
	@p_FECHAINGRESADA AS DATETIME      ,
	@p_FECHALIMITE AS DATETIME      ,
	@p_ID_SUCURSAL AS INT      ,
	@p_ID_USUARIO AS INT      ,
	@p_IDREQUISICION AS INT      ,
	@p_USUARIOENCARGADO AS VARCHAR  ( 250 ) = NULL 
AS
BEGIN

	 IF (@p_IDREQUISICION=-1)
	BEGIN
		INSERT INTO REQUISICION (
		 ESTADO ,
		 FECHAINGRESADA ,
		 FECHALIMITE ,
		 ID_SUCURSAL ,
		 ID_USUARIO ,
		 USUARIOENCARGADO 
		) VALUES (
		 @p_ESTADO, 
		 @p_FECHAINGRESADA, 
		 @p_FECHALIMITE, 
		 @p_ID_SUCURSAL, 
		 @p_ID_USUARIO, 
		 @p_USUARIOENCARGADO 
		)
	END

	ELSE
	BEGIN
		UPDATE REQUISICION 
		SET 
		ESTADO=@p_ESTADO,
		FECHAINGRESADA=@p_FECHAINGRESADA,
		FECHALIMITE=@p_FECHALIMITE,
		ID_SUCURSAL=@p_ID_SUCURSAL,
		ID_USUARIO=@p_ID_USUARIO,
		USUARIOENCARGADO=@p_USUARIOENCARGADO
		WHERE IDREQUISICION=@p_IDREQUISICION
	END
END
