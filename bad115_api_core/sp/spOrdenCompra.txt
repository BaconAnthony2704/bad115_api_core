CREATE PROCEDURE spOrden_compra_ver
@p_id AS BIGINT=NULL
AS
BEGIN
	IF EXISTS(SELECT * FROM ORDEN_COMPRA WHERE ID_ORDEN_COMPRA=@p_id)
		SELECT * FROM ORDEN_COMPRA WHERE ID_ORDEN_COMPRA=@p_id
	ELSE
		SELECT * FROM ORDEN_COMPRA
END

CREATE PROCEDURE spOrden_compra_guardar
	@p_ACTIVO AS BIT      ,
	@p_APROBADA_POR AS INT      ,
	@p_FECHA_APROBACION AS DATETIME      ,
	@p_FECHA_ENTREGA AS DATETIME      ,
	@p_FECHA_ORDEN AS DATETIME      ,
	@p_FECHA_REVISION AS DATETIME      ,
	@p_ID_EMPRESA AS INT      ,
	@p_ID_ORDEN_COMPRA AS INT      ,
	@p_ID_PROVEEDOR AS INT      ,
	@p_IDREQUISICION AS INT      ,
	@p_MODIFICADO_EN AS DATETIME      ,
	@p_MODIFICADO_POR AS INT      ,
	@p_NUMERO_ORDEN AS VARCHAR  ( 10 ) = NULL ,
	@p_OBSERVACIONES AS VARCHAR  ( 500 ) = NULL ,
	@p_REVISADO_POR AS INT      
AS
BEGIN

	 IF (@p_ID_ORDEN_COMPRA=-1)
	BEGIN
		INSERT INTO ORDEN_COMPRA (
		 ACTIVO ,
		 APROBADA_POR ,
		 FECHA_APROBACION ,
		 FECHA_ENTREGA ,
		 FECHA_ORDEN ,
		 FECHA_REVISION ,
		 ID_EMPRESA ,
		 ID_PROVEEDOR ,
		 IDREQUISICION ,
		 MODIFICADO_EN ,
		 MODIFICADO_POR ,
		 NUMERO_ORDEN ,
		 OBSERVACIONES ,
		 REVISADO_POR 
		) VALUES (
		 @p_ACTIVO, 
		 @p_APROBADA_POR, 
		 @p_FECHA_APROBACION, 
		 @p_FECHA_ENTREGA, 
		 @p_FECHA_ORDEN, 
		 @p_FECHA_REVISION, 
		 @p_ID_EMPRESA, 
		 @p_ID_PROVEEDOR, 
		 @p_IDREQUISICION, 
		 @p_MODIFICADO_EN, 
		 @p_MODIFICADO_POR, 
		 @p_NUMERO_ORDEN, 
		 @p_OBSERVACIONES, 
		 @p_REVISADO_POR 
		)
	END

	ELSE
	BEGIN
		UPDATE ORDEN_COMPRA 
		SET 
		ACTIVO=@p_ACTIVO,
		APROBADA_POR=@p_APROBADA_POR,
		FECHA_APROBACION=@p_FECHA_APROBACION,
		FECHA_ENTREGA=@p_FECHA_ENTREGA,
		FECHA_ORDEN=@p_FECHA_ORDEN,
		FECHA_REVISION=@p_FECHA_REVISION,
		ID_EMPRESA=@p_ID_EMPRESA,
		ID_PROVEEDOR=@p_ID_PROVEEDOR,
		IDREQUISICION=@p_IDREQUISICION,
		MODIFICADO_EN=@p_MODIFICADO_EN,
		MODIFICADO_POR=@p_MODIFICADO_POR,
		NUMERO_ORDEN=@p_NUMERO_ORDEN,
		OBSERVACIONES=@p_OBSERVACIONES,
		REVISADO_POR=@p_REVISADO_POR
		WHERE ID_ORDEN_COMPRA=@p_ID_ORDEN_COMPRA
	END
END
